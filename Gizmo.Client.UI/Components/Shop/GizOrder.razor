@namespace Gizmo.Client.UI.Components
@inherits CustomDOMComponentBase
@using System.Globalization

<div class="giz-order">
    <div class="giz-order__items">
        <div class="giz-order__items__header">@LocalizationService.GetString("GIZ_SHOP_ORDER_TITLE")</div>
        <div class="giz-order__items__body giz-scrollbar--v">
            @if (ViewState.Products.Count() > 0)
            {
                <div class="giz-order__items-wrapper">
                    @foreach (var orderLine in ViewState.Products)
                    {
                        <GizOrderItem @key="orderLine" ProductItemViewState="@orderLine" />
                    }
                </div>
            }
            else
            {
                <div class="giz-no-order-wrapper">
                    <div class="giz-empty-state">
                        <div class="giz-empty-state__title">@LocalizationService.GetString("GIZ_SHOP_NO_PRODUCTS_MESSAGE")</div>
                        <div class="giz-empty-state__text">@LocalizationService.GetString("GIZ_SHOP_NO_PRODUCTS_RETRY_MESSAGE")</div>
                    </div>
                </div>
            }
        </div>
    </div>
        
    <div class="giz-order__notes">
        <div class="giz-order__notes__header">@LocalizationService.GetString("GIZ_SHOP_ORDER_NOTE")</div>
        <div class="giz-order__notes__body">
            <TextInput IsTransparent="true"
                       ValidationErrorStyle="ValidationErrorStyles.BorderOnly"
                       Value="@ViewState.Notes"
                       ValueChanged="@((string value) => UserCartService.SetNotes(value))"
                       ValueExpression="@(() => ViewState.Notes)"
                       IsMultiLine="true"
                       IsFullWidth="true"
                       Placeholder="@LocalizationService.GetString("GIZ_SHOP_ORDER_NOTE_PLACEHOLDER")"
                       Class="giz-order-notes" />
        </div>
    </div>

    <div class="giz-order__totals">
        <div class="giz-order-summary">
            <div class="giz-order-summary-text-bold">@LocalizationService.GetString("GIZ_SHOP_SUBTOTAL")</div>
            <div class="giz-order-summary-text">@LocalizationService.GetString("GIZ_SHOP_EARNED_POINTS")</div>
            <div class="giz-order-summary-total @(ViewState.PointsTotal == 0 ? "giz-order-summary-total--no-icon" : "")">@ViewState.Total.ToString("C", CultureInfo.CurrentCulture)<span class="giz-order-summary-number-separator">&amp;</span>@(ViewState.PointsTotal)</div>
            @if (ViewState.PointsTotal == 0)
            {
                <div class="giz-order-summary-points">
                    <div class="giz-order-summary-points-award">@ViewState.PointsAward</div>
                    <div class="giz-order-summary-points-award-icon"><PointsAwardIcon /></div>
                </div>
            }
            else
            {
                <div class="giz-order-summary-points-total-icon"><PointsIcon /></div>
                <div class="giz-order-summary-points-award">@ViewState.PointsAward</div>
                <div class="giz-order-summary-points-award-icon"><PointsAwardIcon /></div>
            }
        </div>
        <div>
            <Button Color="ButtonColors.Accent" Size="ButtonSizes.Large" IsFullWidth="true" IsDisabled="@(ViewState.Products.Count() == 0)" @onclick="@(() => PlaceOrder())" Text="@LocalizationService.GetString("GIZ_SHOP_PLACE_ORDER")" />
        </div>
    </div>
</div>
