@namespace Gizmo.Client.UI.Pages
@inherits CustomDOMComponentBase
@using Gizmo.Client.UI.View.States

<div class="giz-profile giz-scrollbar--v">
    <div class="giz-profile__body-wrapper">
        <div class="giz-profile__body">
            <ProfileHeader />
    
            <ProfileNavigation />

            <div class="giz-user-history giz-user-time-products">
                <div class="giz-user-history__header">
                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_TITLE")
                </div>

                <div class="giz-user-history__body">
                    <DataGrid ItemSource="@ViewState.TimeProducts.ToList()"
                              Context="timeProducts"
                              HasStickyHeader="true"
                              Class="giz-scrollbar--v">
                        <ChildContent>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.ActivationOrder))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    <Icon SVGIcon="Icons.ActivationOrder_Client" Size="IconSizes.Small" Class="giz-user-time-products-order-icon" />
                                </HeaderTemplate>
                                <CellTemplate>
                                    <div class="giz-user-time-products-order @(timeProduct.ActivationOrder == 1 ? "giz-user-time-products-order--current" : "")">
                                        @timeProduct.ActivationOrder
                                    </div>
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.TimeProductType))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_TIME_PRODUCT")
                                </HeaderTemplate>
                                <CellTemplate>
                                    <ProductsProductType TimeProduct="@timeProduct" />
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.Source))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_SOURCE")
                                </HeaderTemplate>
                                <CellTemplate>
                                    @timeProduct.Source
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.Time))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    <div class="giz-user-time-products-time">
                                        <div>
                                            @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_TIME")
                                        </div>
                                    </div>
                                </HeaderTemplate>
                                <CellTemplate>
                                    @if (!string.IsNullOrEmpty(timeProduct.Time))
                                    {
                                        @timeProduct.Time
                                    }
                                    else
                                    {
                                        <Icon SVGIcon="Icons.Infinite" Class="giz-user-time-infinite" Color="#FFC700" />
                                    }
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.PurchaseDate))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_PURCHASE_DATE")
                                </HeaderTemplate>
                                <CellTemplate>
                                    @timeProduct.PurchaseDate.ToString()
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.ExpirationDate))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_AVAILABLE")
                                </HeaderTemplate>
                                <CellTemplate>
                                    @if (timeProduct.ExpirationDate.HasValue)
                                    {
                                        @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_AVAILABLE_UNTIL", timeProduct.ExpirationDate.Value.ToLocalTime().ToString())
                                    }
                                </CellTemplate>
                            </DataGridColumn>
                            @*<DataGridColumn Field="@(nameof(TimeProductViewState.ProductId))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_PROPERTIES")
                                </HeaderTemplate>
                                <CellTemplate>
                                    @if (@timeProduct.ProductId.HasValue)
                                    {
                                        <ProductsProperties ProductId="@timeProduct.ProductId.Value" />
                                    }
                                </CellTemplate>
                            </DataGridColumn>*@
                            <DataGridColumn Field="@(nameof(TimeProductViewState.AvailableHostGroups))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate>
                                    @LocalizationService.GetString("GIZ_USER_TIME_PRODUCTS_HOSTS")
                                </HeaderTemplate>
                                <CellTemplate>
                                    <ProductsProductHosts TimeProduct="@timeProduct" />
                                </CellTemplate>
                            </DataGridColumn>
                            <DataGridColumn Field="@(nameof(TimeProductViewState.AvailableHostGroups))" TItemType="TimeProductViewState" Context="timeProduct">
                                <HeaderTemplate></HeaderTemplate>
                                <CellTemplate>
                                    @if (timeProduct.TimeProductType == UsageType.TimeOffer && timeProduct.ProductId.HasValue)
                                    {
                                        <IconButton Variant="ButtonVariants.Text" SVGIcon="Icons.Open_Client" Size="ButtonSizes.Small" @onclick="@(() => OpenDetails(timeProduct.ProductId.Value))" />
                                        @*TODO: AAA SIZE 20*@
                                    }
                                </CellTemplate>
                            </DataGridColumn>
                        </ChildContent>
                    </DataGrid>
                </div>

            </div>

        </div>
    </div>
</div>