@namespace Gizmo.Client.UI.Pages
@inherits ComponentBase
@layout _Layout_Login
@using System.Threading;
@using Gizmo.Web.Components
@using Gizmo.Client.UI.Components
@using Microsoft.AspNetCore.Components.Forms
@using Gizmo.UI.Services

@inject ILocalizationService localizationService

<LoginCard>
    <CardHeader>
        <div class="giz-login-links">
            <div class="giz-login-new-user">@localizationService.GetString("GIZ_LOGIN_ALREADY_A_MEMBER") <a href="@ClientRoutes.LoginRoute">@localizationService.GetString("GIZ_REGISTRATION_SIGN_ΙΝ")</a></div>
        </div>
    </CardHeader>
    <CardBody>
        <EditForm EditContext="@UserRegistrationConfirmationMethodService.EditContext">
            <div class="giz-login-title">@localizationService.GetString("GIZ_REGISTRATION_SIGN_UP_TITLE")</div>
            @if (UserRegistrationConfirmationMethodService.ViewState.ConfirmationMethod == View.UserRegistrationMethod.Email)
            {
                <div class="giz-login-subtitle--sign-up">Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim</div>
                <div class="giz-form-input">
                    <TextInput @bind-Value="UserRegistrationConfirmationMethodService.ViewState.Email" Size="InputSizes.Medium" IsFullWidth="true" Label="@localizationService.GetString("GIZ_GEN_EMAIL_ADDRESS")"/>
                </div>
            }
            @if (UserRegistrationConfirmationMethodService.ViewState.ConfirmationMethod == View.UserRegistrationMethod.MobilePhone)
            {
                <div class="giz-login-subtitle--sign-up">Please confirm your country code and enter your phone number to create an account.</div>
                <div class="giz-registration-form-input">
                    <CountrySelect HandleSVGIcon="Icons.Select_Client" TValue="Country" Countries="@Countries" @bind-SelectedCountry="@SelectedCountry" Size="InputSizes.Medium" IsFullWidth="true" Label="Country" OpenDirection="PopupOpenDirections.Bottom" Class="giz-input-language-menu" PopupClass="giz-scrollbar--v" />
                </div>
                <div class="giz-form-input">
                    <MaskedTextInput Mask="###-###-###" @bind-Value="UserRegistrationConfirmationMethodService.ViewState.MobilePhone" Size="InputSizes.Medium" IsFullWidth="true" Label="Phone number" />
                </div>
            }
            <div>
                <Button Color="ButtonColors.Accent" Size="ButtonSizes.ExtraLarge" IsFullWidth="true" @onclick="@UserRegistrationConfirmationMethodService.SubmitAsync">
                    <ChildContent>
                        @if (UserRegistrationConfirmationMethodService.ViewState.IsLoading)
                        {
                            <GizSpinner />
                        }
                        else
                        {
                            <div>Send code</div>
                        }
                    </ChildContent>
                </Button>
            </div>
        </EditForm>
    </CardBody>
    <CardFooter>
        <InputLanguageMenu />
    </CardFooter>
</LoginCard>
