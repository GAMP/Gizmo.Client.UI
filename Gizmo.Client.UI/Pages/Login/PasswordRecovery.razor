@namespace Gizmo.Client.UI.Pages
@inherits ComponentBase
@layout _Layout_Login
@using System.Threading;
@using Gizmo.Web.Components
@using Gizmo.Client.UI.Components
@using Microsoft.AspNetCore.Components.Forms
@using Gizmo.UI.Services

@inject ILocalizationService localizationService

<LoginCard>
    <CardHeader>
        <div class="giz-login-new-user">@localizationService.GetString("GIZ_NOT_A_MEMBER") <a href="/registration">@localizationService.GetString("GIZ_SIGN_UP_NOW")</a></div>
    </CardHeader>
    <CardBody>
        <EditForm EditContext="@UserPasswordRecoveryService.EditContext">
            <div class="giz-login-title">@localizationService.GetString("GIZ_FORGOT_PASSWORD")</div>
            <div>
                <ButtonGroup Class="giz-recovery-method" IsMandatory="true" SelectedItemsChanged="@SelectRecoveryMethod">
                    <Button Name="Phone" IsSelected="@(UserPasswordRecoveryService.ViewState.Method == View.UserPasswordRecoveryMethod.MobilePhone)">@localizationService.GetString("GIZ_PHONE_NUMBER")</Button>
                    <Button Name="Email" IsSelected="@(UserPasswordRecoveryService.ViewState.Method == View.UserPasswordRecoveryMethod.Email)">@localizationService.GetString("GIZ_EMAIL")</Button>
                </ButtonGroup>
            </div>
            <div class="giz-login-subtitle">
                @if (UserPasswordRecoveryService.ViewState.Method == View.UserPasswordRecoveryMethod.Email)
                {
                    @localizationService.GetString("GIZ_PASSWORD_RECOVERY_ENTER_EMAIL")
                }
                else
                {
                    @localizationService.GetString("GIZ_PASSWORD_RECOVERY_ENTER_PHONE_NUMBER")
                }
            </div>
            <div class="giz-login-input">
                @if (UserPasswordRecoveryService.ViewState.Method == View.UserPasswordRecoveryMethod.Email)
                {
                    <TextInput @bind-Value="UserPasswordRecoveryService.ViewState.Email" Size="InputSizes.Normal" IsFullWidth="true" Label="Email address"/>
                }
                else
                {
                    <MaskedTextInput Mask="###.###-###!###" @bind-Value="UserPasswordRecoveryService.ViewState.MobilePhone" Size="InputSizes.Normal" IsFullWidth="true" Label="@localizationService.GetString("GIZ_PHONE_NUMBER")" />
                }
            </div>
            <div class="giz-login-input">
                <Button Color="ButtonColors.Accent" Size="ButtonSizes.ExtraLarge" IsFullWidth="true" @onclick="@UserPasswordRecoveryService.SubmitAsync">@localizationService.GetString("GIZ_CONTINUE")</Button>
            </div>
        </EditForm>
    </CardBody>
    <CardFooter>
        <KeyboardLanguage />
    </CardFooter>
</LoginCard>
